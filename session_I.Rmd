|---
title: "Session I: Introduction to Deep Learning"
author: "Rick Scavetta"
output:
  html_document:
  fig_caption: true
toc: true
toc_float:
  collapsed: false
smooth_scroll: false
toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE, eval = FALSE)

# Initialize package
library(keras)
```

## Learning Goals

Developing deep learning to two core questions in supervised learning: Classification and Regression. 

The UCI Abalone data-set is a small and easy starting point since it can be used for predicting age as either a categorical or continuous variable, leading to the 

## Outline

- What is a tensor and why use it?
- What is keras and what is its relationship to TensorFlow?
- What is the deep in deep learning? ANNs and densely-connected networks.
- The math of deep learning: Basics of matrix algebra, gradient descent, backpropagarion, chain rule.
- The four stages of Deep learning.
- Parameters and hyper-parameter.
- Functions distinguishing classification and regression: loss and optimizer functions.

## Functions in this session:

Table: (\#tab:FunIa) Basic `keras` functions.

| Function                   | Description                                       |
|:---------------------------|:--------------------------------------------------| 
| [`keras_model_sequential()`](https://www.rdocumentation.org/packages/keras/versions/2.2.0/topics/keras_model_sequential) | Keras Model composed of a linear stack of layers. |
| `layer_dense()`	           | Add a densely-connected NN layer to an output.    |
| `compile()`                | Configure a Keras model for training.             |
| `fit()`                    | Train a Keras model.                              |

```{r results = 'asis', eval = TRUE}
knitr::kable(mtcars[1:5,])
```

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0pky">Function</th>
    <th class="tg-0pky">Description</th>
  </tr>
  <tr>
    <td class="tg-0pky">[`keras_model_sequential()`](https://www.rdocumentation.org/packages/keras/versions/2.2.0/topics/keras_model_sequential)</td>
    <td class="tg-0pky">Keras Model composed of a linear stack of layers.</td>
  </tr>
  <tr>
    <td class="tg-0pky">`layer_dense()`</td>
    <td class="tg-0pky">Add a densely-connected NN layer to an output.</td>
  </tr>
  <tr>
    <td class="tg-0pky">`compile()`</td>
    <td class="tg-0pky">Configure a Keras model for training.</td>
  </tr>
  <tr>
    <td class="tg-0pky">`fit()`</td>
    <td class="tg-0pky">Train a Keras model.</td>
  </tr>
</table>



```{r tables-mtcars, eval = TRUE}
knitr::kable(iris[1:5, ], caption = 'A caption')
```


| Notation               | Description                                                    |
|------------------------|----------------------------------------------------------------|
| `>`                    | The R command prompt.                                          |
| `n`                    | An object name.                                                |
| `<-`                   | The assign operator.                                           |
| `log2()`               | The function to be solved. The solution will be assigned to n. |
| `8`                    | The function's argument.                                       |
| `#`                    | The beginning of the comment.                                  |
| `The logarithm of ...` | The comment.                                                   |
| `[]`                   | Refers to the index of the output.                             |
| `1`                    | The index number.                                              |
| `3`                    | The value at position `[1]`.                                   |


The following table will help you to make sense of the above example.

Table: (\#tab:syntax) R's syntax.

| Notation               | Description                                                    |
|------------------------|----------------------------------------------------------------|
| `>`                    | The R command prompt.                                          |
| `n`                    | An object name.                                                |
| `<-`                   | The assign operator.                                           |
| `log2()`               | The function to be solved. The solution will be assigned to n. |
| `8`                    | The function's argument.                                       |
| `#`                    | The beginning of the comment.                                  |
| `The logarithm of ...` | The comment.                                                   |
| `[]`                   | Refers to the index of the output.                             |
| `1`                    | The index number.                                              |
| `3`                    | The value at position `[1]`.                                   |




And another one:

<p>| Function                   | Description                                       |
|:---------------------------|:--------------------------------------------------| 
| <a href="https://www.rdocumentation.org/packages/keras/versions/2.2.0/topics/keras_model_sequential"><code>keras_model_sequential()</code></a> | Keras Model composed of a linear stack of layers. |
| <code>layer_dense()</code>               | Add a densely-connected NN layer to an output.    |
| <code>compile()</code>                | Configure a Keras model for training.             |
| <code>fit()</code>                    | Train a Keras model.                              |</p>


## Abalone Examples


| Variable       | Type       | Unit  | Description                 |
|----------------|------------|-------|-----------------------------|
| sex            | nominal    | --    | M, F, and I (infant)        |
| length         | continuous | mm    | Longest shell measurement   |
| diameter       | continuous | mm    | perpendicular to length     | 
| height         | continuous | mm    | with meat in shell          |
| whole_weight   | continuous | grams | whole abalone               |
| shucked_weight | continuous | grams | weight of meat              |
| viscera_weight | continuous | grams | gut weight (after bleeding) | 
| shell_weight   | continuous | grams | after being dried           | 
| rings          | integer    | --    | +1.5 gives the age in years |

The number of rings, variable `rings`, is the value to predict as either a continuous value or as a classification problem. 

```{r eval = TRUE}

abalone <- read.csv("Abalone/abalone.data", 
                   col.names = c("sex",
                                 "length",
                                 "diameter",
                                 "height",
                                 "whole_weight",
                                 "shucked_weight",
                                 "viscera_weight",
                                 "shell_weight",
                                 "rings"))

```

### Explore the data set

```{r eval = TRUE}
library(ggplot2)
tabplot::tableplot(abalone)
```

```{r eval = TRUE}
ggplot(abalone, aes(rings)) +
  geom_bar() +
  scale_x_continuous("Number of Rings", breaks = 1:29) +
  coord_cartesian(expand = 0) +
  theme_minimal()

```

number of training instances n = `r round(0.8*nrow(abalone))`.

number of test instances n = `r round(0.2*(nrow(abalone)))`.

number of features d = `r ncol(abalone) - 1`.

number of classes K = `r length(unique(abalone$rings))`.

```{r eval = TRUE}
abalone_results <- abalone[,9]
abalone_data <- abalone[1:8]

# 3342/(3342 + 835)
```

### Split up training and test
